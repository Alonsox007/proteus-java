syntax = "proto3";

package io.netifi.proteus.broker.info;

import "proteus/core.proto";
import "proteus/broker_info.proto";

option java_package = "io.netifi.proteus.broker.mgmt";
option java_outer_classname = "BrokerManagement";
option java_multiple_files = true;

message Brokers {
    repeated io.netifi.proteus.broker.info.Broker brokers = 1;
}

service BrokerManagementService {
    // Shutdowns down a broker process
    rpc shutdown (io.netifi.proteus.Empty) returns (io.netifi.proteus.Empty) {}

    // Broker leaves the cluster, but stays running
    rpc leave (io.netifi.proteus.Empty) returns (io.netifi.proteus.Ack) {}

    // Rejoins the cluster it  has seed information for
    rpc rejoin (io.netifi.proteus.Empty) returns (io.netifi.proteus.Ack) {}

    // Tells the Broker to join using the provided Brokers
    rpc join (Brokers) returns (io.netifi.proteus.Ack) {}

    // Closes connections to a specific set of destinations
    rpc closeDestination (stream io.netifi.proteus.broker.info.Destination) returns (io.netifi.proteus.Ack) {}

    // Closes connections to a specific set of groups
    rpc closeGroup (stream io.netifi.proteus.broker.info.Group) returns (io.netifi.proteus.Ack) {}

    // Closes connections to a specific set of brokers
    rpc closeBroker (stream io.netifi.proteus.broker.info.Broker) returns (io.netifi.proteus.Ack) {}

    // Closes all connections on the broker - except broker to broker connections
    rpc closeDestinations (io.netifi.proteus.Empty) returns (io.netifi.proteus.Ack) {}

    // Closes connections to all other brokers
    rpc closeBrokers (io.netifi.proteus.Empty) returns (io.netifi.proteus.Ack) {}

    // Closes all connections on the broker including broker to broker connections
    rpc closeAll (io.netifi.proteus.Empty) returns (io.netifi.proteus.Ack) {}
}
